<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>IITM | Mess Analytics</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        :root {
            --navy-bg: #e9eff5; --iitm-blue: #002D62;
            --warm-accent: #fdf5e6; --gold-text: #b8860b;
        }
        body { background-color: var(--navy-bg); color: #333; font-family: 'Segoe UI', sans-serif; }

        /* Header Upgrade */
        .navbar { background: white; border-bottom: 4px solid var(--iitm-blue); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .slogan { color: var(--iitm-blue); font-style: italic; font-size: 0.9rem; border-top: 1px solid #ddd; margin-top: 2px; }

        /* Card Styling */
        .glass-card { background: white; border: none; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,45,98,0.08); }
        .hero-card { background: var(--iitm-blue); color: white; border-radius: 12px; }

        .alert-warm {
            background: var(--warm-accent); border-left: 5px solid var(--gold-text);
            color: #5d4037; box-shadow: 0 2px 15px rgba(184, 134, 11, 0.1);
        }

        .btn-iitm { background: var(--iitm-blue); color: white; border-radius: 8px; font-weight: 600; padding: 12px; }
        .btn-iitm:hover { background: #001a3a; color: #fff; transform: translateY(-1px); }

        .table-container { background: white; border-radius: 12px; overflow: hidden; }
        .table thead { background: #f1f4f8; color: var(--iitm-blue); }
    </style>
</head>
<body class="container py-4">

<nav class="navbar fixed-top px-4">
    <div class="d-flex align-items-center">
        <img src="https://upload.wikimedia.org/wikipedia/en/thumb/6/69/IIT_Madras_Logo.svg/1200px-IIT_Madras_Logo.svg.png"
             alt="IITM Logo" height="70" class="me-3">
        <div>
            <div style="font-size: 1.8rem; font-weight: 800; color: var(--iitm-blue); line-height: 1;">INDIAN INSTITUTE OF TECHNOLOGY MADRAS</div>
            <div class="slogan">Siddhirbhavati Karmaja (Success is born of action)</div>
        </div>
    </div>
</nav>

<div style="margin-top: 120px;">
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="card hero-card p-4 shadow h-100">
                <small class="text-uppercase opacity-75">Cumulative Research Waste</small>
                <h1 class="display-4 fw-bold" th:text="${totalWaste} + ' kg'">0.00 kg</h1>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card glass-card p-4 alert-warm h-100 border-0">
                <h5 class="fw-bold"><span class="me-2">ðŸ’¡</span>Smart Analytics Prediction</h5>
                <p class="fs-5 mb-0" th:text="${prediction}"></p>
            </div>
        </div>
    </div>

    <div class="card glass-card p-4 mb-5">
        <h5 class="mb-4 fw-bold" style="color: var(--iitm-blue);">Log Daily Waste Entry</h5>
        <form action="/add" method="post" class="row g-3">
            <div class="col-md-3"><label class="form-label fw-semibold">Date</label><input type="date" name="date" class="form-control" required></div>
            <div class="col-md-3">
                <label class="form-label fw-semibold">Meal Type</label>
                <select name="mealType" class="form-select">
                    <option>Breakfast</option><option>Lunch</option><option>Snacks</option><option>Dinner</option>
                </select>
            </div>
            <div class="col-md-3"><label class="form-label fw-semibold">Produced (kg)</label><input type="number" step="0.1" name="foodProducedKg" class="form-control" required></div>
            <div class="col-md-3"><label class="form-label fw-semibold">Consumed (kg)</label><input type="number" step="0.1" name="foodConsumedKg" class="form-control" required></div>
            <div class="col-12"><button type="submit" class="btn btn-iitm w-100 shadow-sm">SAVE TO RESEARCH DATABASE</button></div>
        </form>
    </div>

    <div class="table-container shadow-sm p-4">
        <h5 class="mb-4 fw-bold" style="color: var(--iitm-blue);">Waste Audit Log</h5>
        <table class="table table-hover align-middle">
            <thead>
            <tr><th>Date</th><th>Meal</th><th>Produced</th><th>Consumed</th><th>Wasted</th><th>Status</th></tr>
            </thead>
            <tbody>
            <tr th:each="w : ${wasteList}">
                <td th:text="${w.date}"></td>
                <td><span class="badge bg-light text-dark border" th:text="${w.mealType}"></span></td>
                <td th:text="${w.foodProducedKg} + ' kg'"></td>
                <td th:text="${w.foodConsumedKg} + ' kg'"></td>
                <td class="fw-bold" th:text="${w.foodWastedKg} + ' kg'"></td>
                <td>
                    <span th:if="${w.foodWastedKg > (w.foodProducedKg * 0.2)}" class="badge bg-danger">HIGH WASTE</span>
                    <span th:unless="${w.foodWastedKg > (w.foodProducedKg * 0.2)}" class="badge bg-success">Optimal</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>